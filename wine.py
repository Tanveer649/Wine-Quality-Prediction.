# -*- coding: utf-8 -*-
"""Untitled39.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1iRozBsTB1abV5zPBBkm0YGYgNGM-SCoM
"""

import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns


from warnings import filterwarnings
filterwarnings(action='ignore')

wine = pd.read_csv("/content/winequality-red.csv")
wine.sample(25)

wine.info()

wine.describe()

wine.isnull().sum()

wine.groupby('quality').mean()

sns.countplot(wine['quality'])
plt.show()



wine.plot(kind ='box',subplots = True, layout =(4,4),sharex = False)

wine['fixed acidity'].plot(kind ='box')

wine.hist(figsize=(10,10),bins=50)
plt.show()

wine.sample(5)

wine['quality'].unique()

# If wine quality is 7 or above then will consider as good quality wine
wine['goodquality'] = [1 if x >= 7 else 0 for x in wine['quality']]
wine.sample(5)

# See total number of good vs bad wines samples
wine['goodquality'].value_counts()

# Separate depedent and indepedent variables
X = wine.drop(['quality','goodquality'], axis = 1)
Y = wine['goodquality']

print(Y)

from sklearn.ensemble import ExtraTreesClassifier
classifiern = ExtraTreesClassifier()
classifiern.fit(X,Y)
score = classifiern.feature_importances_
print(score)

from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(X,Y,test_size=0.3,random_state=7)

model_res=pd.DataFrame(columns=['Model', 'Score'])

